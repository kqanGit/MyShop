<Page
    x:Class="MyShop_Frontend.Views.Pages.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MyShop_Frontend.Views.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:lvc="using:LiveChartsCore.SkiaSharpView.WinUI"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- Base card style -->
        <Style x:Key="CardBorderStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="18"/>
            <Setter Property="Padding" Value="18"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#11000000"/>
        </Style>

        <!-- Pill style button (Today) -->
        <Style x:Key="PillButtonStyle" TargetType="Button">
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Background" Value="#F3F5F9"/>
            <Setter Property="BorderBrush" Value="#11000000"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Pastel backgrounds like the screenshot -->
        <SolidColorBrush x:Key="CardPink" Color="#FFEFF3"/>
        <SolidColorBrush x:Key="CardBeige" Color="#FFF7EA"/>
        <SolidColorBrush x:Key="CardMint" Color="#E9FFEF"/>
        <SolidColorBrush x:Key="CardLavender" Color="#F1EBFF"/>
        <SolidColorBrush x:Key="CardLightBlue" Color="#EEF4FF"/>

        <SolidColorBrush x:Key="IconPink" Color="#FFD7DD"/>
        <SolidColorBrush x:Key="IconOrange" Color="#FFE1B8"/>
        <SolidColorBrush x:Key="IconGreen" Color="#C9F2D0"/>
        <SolidColorBrush x:Key="IconPurple" Color="#E2D6FF"/>
        <SolidColorBrush x:Key="IconBlue" Color="#D9E6FF"/>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Padding="24" RowSpacing="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- KPI Cards -->
                <RowDefinition Height="Auto"/>
                <!-- Charts -->
                <RowDefinition Height="Auto"/>
                <!-- Tables -->
            </Grid.RowDefinitions>


            <!-- ===== ROW 1: KPI CARDS ===== -->
            <Grid Grid.Row="0" ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Card 1: Revenue -->
                <Border Grid.Column="0" Background="White" CornerRadius="16" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12">
                            <Border Background="#EEF2FF" CornerRadius="10" Padding="10">
                                <FontIcon Glyph="&#xE8C8;" FontSize="18" Foreground="#5D5FEF"/>
                            </Border>
                            <TextBlock Text="Total Revenue" 
                                   Foreground="#64748B" 
                                   VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" 
                               Text="{x:Bind ViewModel.TotalRevenue, Mode=OneWay}"
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#1E293B"
                               Margin="0,12,0,4"/>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="6">
                            <TextBlock Text="{x:Bind ViewModel.RevenueChangePercent, Mode=OneWay}" 
                                       Foreground="{x:Bind ViewModel.RevenueChangeColor, Mode=OneWay}" 
                                       FontSize="13"/>
                            <TextBlock Text="growth in period" Foreground="#94A3B8" FontSize="13"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 2: Profit -->
                <Border Grid.Column="1" Background="White" CornerRadius="16" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12">
                            <Border Background="#ECFDF5" CornerRadius="10" Padding="10">
                                <FontIcon Glyph="&#xE9D9;" FontSize="18" Foreground="#22C55E"/>
                            </Border>
                            <TextBlock Text="Total Profit" 
                                   Foreground="#64748B" 
                                   VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" 
                               Text="{x:Bind ViewModel.TotalProfit, Mode=OneWay}"
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#1E293B"
                               Margin="0,12,0,4"/>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="6">
                            <TextBlock Text="{x:Bind ViewModel.ProfitChangePercent, Mode=OneWay}" 
                                       Foreground="{x:Bind ViewModel.ProfitChangeColor, Mode=OneWay}" 
                                       FontSize="13"/>
                            <TextBlock Text="growth in period" Foreground="#94A3B8" FontSize="13"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 3: Orders -->
                <Border Grid.Column="2" Background="White" CornerRadius="16" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12">
                            <Border Background="#FEF3C7" CornerRadius="10" Padding="10">
                                <FontIcon Glyph="&#xE7BF;" FontSize="18" Foreground="#F59E0B"/>
                            </Border>
                            <TextBlock Text="Total Orders" 
                                   Foreground="#64748B" 
                                   VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" 
                               Text="{x:Bind ViewModel.TotalOrders, Mode=OneWay}"
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#1E293B"
                               Margin="0,12,0,4"/>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="6">
                            <TextBlock Text="{x:Bind ViewModel.AverageOrderValue, Mode=OneWay}" 
                                       Foreground="#64748B" 
                                       FontSize="13"/>
                            <TextBlock Text="avg. order" Foreground="#94A3B8" FontSize="13"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Card 4: Products Sold -->
                <Border Grid.Column="3" Background="White" CornerRadius="16" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="12">
                            <Border Background="#FCE7F3" CornerRadius="10" Padding="10">
                                <FontIcon Glyph="&#xE821;" FontSize="18" Foreground="#EC4899"/>
                            </Border>
                            <TextBlock Text="Products Sold" 
                                   Foreground="#64748B" 
                                   VerticalAlignment="Center"/>
                        </StackPanel>

                        <TextBlock Grid.Row="1" 
                               Text="{x:Bind ViewModel.TotalProductsSold, Mode=OneWay}"
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#1E293B"
                               Margin="0,12,0,4"/>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="6">
                            <TextBlock Text="{x:Bind ViewModel.NewCustomers, Mode=OneWay}" 
                                       Foreground="#64748B" 
                                       FontSize="13"/>
                            <TextBlock Text="new customers" Foreground="#94A3B8" FontSize="13"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- ===== ROW 2: CHARTS ===== -->
            <Grid Grid.Row="1" ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Revenue/Profit Chart -->
                <Border Grid.Column="0" Background="White" CornerRadius="16" Padding="24">
                    <Grid RowSpacing="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="300"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="16">
                            <TextBlock Text="Revenue &amp; Profit Trend" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"/>

                            <!-- Legend -->
                            <StackPanel Orientation="Horizontal" Spacing="16" Margin="24,0,0,0">
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <Ellipse Width="10" Height="10" Fill="#5D5FEF"/>
                                    <TextBlock Text="Revenue" Foreground="#64748B" FontSize="13"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <Ellipse Width="10" Height="10" Fill="#22C55E"/>
                                    <TextBlock Text="Profit" Foreground="#64748B" FontSize="13"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>

                        <!-- LiveCharts2 Chart -->
                        <lvc:CartesianChart Grid.Row="1"
                                            Series="{x:Bind ViewModel.RevenueProfitSeries, Mode=OneWay}"
                                            XAxes="{x:Bind ViewModel.XAxes, Mode=OneWay}"
                                            YAxes="{x:Bind ViewModel.YAxes, Mode=OneWay}"
                                            TooltipPosition="Top"
                                            ZoomMode="X"/>
                    </Grid>
                </Border>

                <!-- Top Products -->
                <Border Grid.Column="1" Background="White" CornerRadius="16" Padding="24">
                    <Grid RowSpacing="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" 
                               Text="Top Selling Products" 
                               FontSize="16" 
                               FontWeight="SemiBold"/>

                        <ListView Grid.Row="1"
                              ItemsSource="{x:Bind ViewModel.TopProducts, Mode=OneWay}"
                              SelectionMode="None">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="0,12" ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Rank Badge -->
                                        <Border Grid.Column="0" 
                                            Background="#EEF2FF" 
                                            CornerRadius="8"
                                            Width="32" Height="32">
                                            <TextBlock Text="{Binding Rank}"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold"
                                                   Foreground="#5D5FEF"/>
                                        </Border>

                                        <!-- Product Info -->
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding ProductName}" 
                                                   FontWeight="Medium"
                                                   TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{Binding QuantitySoldText}" 
                                                   Foreground="#64748B" 
                                                   FontSize="12"/>
                                        </StackPanel>

                                        <!-- Revenue -->
                                        <TextBlock Grid.Column="2" 
                                               Text="{Binding RevenueText}"
                                               FontWeight="SemiBold"
                                               Foreground="#22C55E"
                                               VerticalAlignment="Center"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Border>
            </Grid>

            <!-- ===== ROW 3: TABLES ===== -->
            <Grid Grid.Row="2" ColumnSpacing="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Recent Orders -->
                <Border Grid.Column="0" Background="White" CornerRadius="16" Padding="24">
                    <Grid RowSpacing="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <TextBlock Text="Recent Orders" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"/>
                            <HyperlinkButton Content="View All â†’" 
                                         Margin="12,0,0,0"
                                         Foreground="#5D5FEF"/>
                        </StackPanel>

                        <!-- Orders Table -->
                        <Border Grid.Row="1" 
                            Background="#F8FAFC" 
                            CornerRadius="12"
                            Padding="16"
                            MinHeight="200">
                            <TextBlock Text="[Recent Orders DataGrid]"
                                   Foreground="#94A3B8"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </Border>

                <!-- Low Stock Alert -->
                <Border Grid.Column="1" Background="White" CornerRadius="16" Padding="24">
                    <Grid RowSpacing="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE7BA;" FontSize="16" Foreground="#EF4444"/>
                            <TextBlock Text="Low Stock Alert" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"/>
                            <Border Background="#FEE2E2" 
                                CornerRadius="12" 
                                Padding="8,4">
                                <TextBlock Text="{x:Bind ViewModel.LowStockCount, Mode=OneWay}" 
                                       Foreground="#EF4444" 
                                       FontSize="12"
                                       FontWeight="SemiBold"/>
                            </Border>
                        </StackPanel>

                        <ListView Grid.Row="1"
                              ItemsSource="{x:Bind ViewModel.LowStockProducts, Mode=OneWay}"
                              SelectionMode="None">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="0,10" ColumnSpacing="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" 
                                               Text="{Binding ProductName}"
                                               TextTrimming="CharacterEllipsis"/>

                                        <Border Grid.Column="1" 
                                            Background="#FEE2E2" 
                                            CornerRadius="6"
                                            Padding="8,4">
                                            <TextBlock Text="{Binding StockText}"
                                                   Foreground="#EF4444"
                                                   FontSize="12"
                                                   FontWeight="Medium"/>
                                        </Border>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </ScrollViewer>
</Page>